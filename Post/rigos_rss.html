<!DOCTYPE html>
<html lang="zh" class='han-la' data-theme="dark">

<head>
  <script src="/js/jquery-3.7.0.min.js"></script>
  <script src="/js/jquery.toc.min.js"></script>
  <!-- THEME-->
  <link rel="stylesheet" href="/css/pico.css">
  <link rel="stylesheet" href="/css/custom.css">
  <script>
    function addFontSize(addPx) {
      html = document.querySelector('html');
      currentSize = parseFloat(window.getComputedStyle(html, null)
        .getPropertyValue('font-size'));
      html.style.fontSize = (currentSize + addPx) + 'px';
    }
    function toggleDarkMode(el) {
      var theme = 'dark'
      if (!el.checked) {
        theme = 'light';
      } else {
        var theme = 'dark';
      }
      document.documentElement.setAttribute('data-theme', theme)
    }
  </script>
  <!-- prism.js -->
  <link href="/css/prism.css" rel="stylesheet" />
  <!-- KaTex-->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css"
    integrity="sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn" crossorigin="anonymous">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"
    integrity="sha384-cpW21h6RZv/phavutF+AuVYrr+dA8xD9zs6FwLpaCct6O9ctzYFfFr4dgmgccOTx"
    crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"
    integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05"
    crossorigin="anonymous"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      renderMathInElement(document.body, {
        // customised options
        // • auto-render specific keys, e.g.:
        delimiters: [
          { left: '$$', right: '$$', display: true },
          { left: '$', right: '$', display: false },
          { left: '\\(', right: '\\)', display: false },
          { left: '\\[', right: '\\]', display: true }
        ],
        // • rendering keys, e.g.:
        throwOnError: false
      });
    });
  </script>
  <!-- text-autospace.js -->
  <script src='https://cdn.bootcss.com/jquery/2.1.1/jquery.min.js'></script>
  <script src='https://mastermay.github.io/text-autospace.js/text-autospace.min.js'></script>
  <!-- Google font预加载&缓存 -->
  <link type="text/css" rel="preload stylesheet" as="style"
    href="https://fonts.googleapis.com/css2?family=Noto+Sans+Mono:ital,wght@0,400;0,700;1,400;1,700&family=Noto+Serif+SC:wght@300;400;500;600;700&display=swap"
    crossorigin>
  <!-- Google font预加载&缓存 -->
  <link rel="dns-prefetch" href="https://fonts.googleapis.com/">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com/">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <noscript>
    <link rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+Mono:ital,wght@0,400;0,700;1,400;1,700&family=Noto+Serif+SC:wght@300;400;500;600;700&display=swap"
      onload="this.media='all'" />
  </noscript>
  <!-- Google font预加载&缓存 END-->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-lite-webfont@1.0.0/style.css" />
  <!--Typer-->
  <script src="https://unpkg.com/typeit@8.7.1/dist/index.umd.js"></script>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Candlest's Blog</title>
</head>

<body data-theme="dark" lang="zh-Hans-CN" data-prismjs-copy="复制文本" data-prismjs-copy-error="按Ctrl+C复制"
  data-prismjs-copy-success="文本已复制！">
  <script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true, theme: 'dark',});
  </script>
  <main class="container">
    <nav id="container">
      <ul>
        <li><a href="/">主页</a></li>
        <li>
          <details role="list" dir="rtl">
            <summary aria-haspopup="listbox" role="link">文章</summary>
            <ul role="listbox">
              <li><a href="/categories.html">专栏</a></li>
              <li><a href="/tags.html">标签</a></li>
            </ul>
          </details>
        </li>
        <li>
          <details role="list" dir="rtl">
            <summary aria-haspopup="listbox" role="link">关于</summary>
            <ul role="listbox">
              <li><a href="/about_page.html">关于博客</a></li>
              <li><a href="/about_me.html">关于我</a></li>
            </ul>
          </details>
        </li>
      </ul>
      <ul>
        <!-- <li class="float-left sticky"># Candlest 's Blog</li> -->
        <li><a href="/feed.xml">RSS</a></li>
        <li><a href="/friends.html">友链</a></li>
        <li><a href="/gk.html">高考专栏</a></li>
      </ul>
    </nav>
    <center>
      <p id="top-text"></p>
  </center>
  <script>
    new TypeIt("#top-text", {
      strings: "纵被春风吹作雪，绝胜南陌碾成尘。<em>—— [宋]王安石《北陂杏花》</em>",
      speed: 50,
      waitUntilVisible: true,
    }).go();
  </script>
    <div class="line-numbers">
      
<div>
  <header>
    <h1 align="center">给静态博客实现rss</h1>
    <p align="center"><small><span>2023-09-30 12:31 |
          <a href="/categories.html#Rigos">Rigos</a> | <a href="/tags.html#Rust">#Rust#</a> <a href="/tags.html#Blog">#Blog#</a> </span></small></p>
  </header>
  <details class="hover-open card">
    <summary> 目录 </summary>
    <ul data-toc></ul>
   </details>
  <div id="container">
    <p>手痒了，想给博客添加 <code>feed.xml</code> 以实现 rss 功能。</p>
<p>实现原理和 tera 的 html 模板渲染大差不差，大概思路就是遍历一边文章。</p>
<p>模板文件：</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;rss version=&quot;2.0&quot;&gt;
    &lt;channel&gt;
        &lt;title&gt;Candlest's Blog&lt;/title&gt;
        &lt;link&gt;http://candlest.github.io/&lt;/link&gt;
        &lt;description&gt;Candlest 的博客&lt;/description&gt;
        &lt;language&gt;zh-cn&lt;/language&gt;

        {% for post in post_index | sort(attribute=&quot;datetime&quot;) |reverse%}
        &lt;item&gt;
            &lt;title&gt;{{post.title}}&lt;/title&gt;
            &lt;link&gt;https://candlest.github.io/Post/{{post.url_name}}&lt;/link&gt;
        &lt;/item&gt;
        {% endfor %}
    &lt;/channel&gt;
&lt;/rss&gt;
</code></pre>
<p>代码：</p>
<pre><code class="language-rust">impl Builder
{
    /* ... */
    pub fn build_feed(&amp;self) {
        let tera = match Tera::new(
            format!(
                &quot;{}/{}/{}/*.html&quot;,
                self.project_root_path, self.config.template_dir, self.config.theme
            )
            .as_str(),
        ) {
            Ok(t) =&gt; t,
            Err(e) =&gt; {
                println!(&quot;Parsing error(s): {}&quot;, e);
                ::std::process::exit(1);
            }
        };
        let mut context = tera::Context::new();
        context.insert(&quot;post_index&quot;, &amp;self.posts_index);
        context.insert(&quot;tags&quot;, &amp;self.tags);
        context.insert(&quot;categories&quot;, &amp;self.categroies);
        //render
        let rendered = tera.render(&quot;feed.html&quot;, &amp;context).unwrap();
        //let folder = std::path::Path::new(html_output_path.as_str());
        //let _ = std::fs::create_dir_all(folder);
        let html_output_path = format!(&quot;{}/feed.xml&quot;, self.config.public_dir);
        std::fs::write(html_output_path, rendered).unwrap();
    }
}
/* ... */
pub fn build() {
    let pro_path = String::from(&quot;./&quot;);
    let builder = Builder::new(pro_path);
    let mut builder_o = builder.clone();
    utils::info(utils::Info::GENERATE, &quot;now generate&quot;, utils::PUBLIC_DIR);
    let handle_static = std::thread::spawn(move || {
        builder.build_static_dir();
    });
    builder_o.pre_create_posts_index();
    builder_o.build_all();
    builder_o.build_feed();
    handle_static.join().unwrap();
}
</code></pre>
  </div>
</div>

      <div id="commit">
        <script src="https://giscus.app/client.js" data-repo="candlest/candlest.github.io" data-repo-id="R_kgDOJ_ICfw"
          data-category="Announcements" data-category-id="DIC_kwDOJ_ICf84CYNFn" data-mapping="pathname" data-strict="0"
          data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="dark"
          data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous" async>
          </script>
      </div>
      <script src="/js/prism.js"></script>
    </div>
    <footer>
      <p align="center">
        <small>
          <i>generated by <a href="https://github.com/Candlest/rigos">rigos</a>, beautified by <a
              href="https://picocss.com/">pico.css</a>.</i>
        </small>
      </p>
    </footer>
  </main>
  <!-- <button class="contrast switcher">
    <label for="switch">
      <input type="checkbox" id="switch" name="switch" role="switch" onclick="toggleDarkMode(this)" checked="true">
      <font style="vertical-align: inherit;">
        <font style="vertical-align: inherit;">黑夜模式</font>
      </font>
    </label>
    </a>
    </li>
  </button> -->
</body>

</html>